# #49: Volatility Task1-9

Volatility is a free memory forensics tool developed and maintained by Volatility Foundation, commonly used by malware and SOC analysts within a blue team or as part of their detection and monitoring solutions. Volatility is written in Python and is made up of python plugins and modules designed as a plug-and-play way of analyzing memory dumps.

Volatility is available for Windows, Linux, and Mac OS and is written purely in Python.

*(TryHackMe Room: [Volatility](https://tryhackme.com/room/volatility))*

---

![5e86dbbd98fde62929a7e03b-1759493554864.png](5e86dbbd98fde62929a7e03b-1759493554864.png)

### Purpose

- Helps extract digital artifacts such as:
    - Running processes
    - Network connections
    - Code injections
    - Rootkits and hidden malware

---

## **Task 2: Volatility Overview**

![5e86dbbd98fde62929a7e03b-1759493693103.png](5e86dbbd98fde62929a7e03b-1759493693103.png)

### Definition

> Volatility is the most widely used framework for extracting digital artifacts from volatile memory (RAM) samples ‚Äî independent of the system being analyzed.
> 

### Key Points

- Provides **visibility into runtime state** of a system.
- Works **independently** of the machine being investigated.
- Built around **plugins** that extract specific information.
- Before analyzing any dump:
    1. Identify **image type** (OS and build)
    2. Use the right **plugin commands** for that OS

### Versions

- Two main versions exist:
    - **Volatility 2** ‚Üí Python 2 (old syntax)
    - **Volatility 3** ‚Üí Python 3 (modern version; used in this room)
- Recommended Repo:
    
    üîó [Volatility3 GitHub](https://github.com/volatilityfoundation/volatility3)
    

---

## **Task 3: Installing Volatility**

![python-logo-inkscape.svg](python-logo-inkscape.svg)

### Installation Steps

1. **Clone repository**
    
    ```bash
    git clone https://github.com/volatilityfoundation/volatility3.git
    ```
    
2. **Install dependencies:**
    - Python 3.5.3+
    - pefile 2017.8.1+ (https://pypi.org/project/pefile/)
    - *(Optional but recommended)*:
        - yara-python 3.8.0+ (https://github.com/VirusTotal/yara-python)
        - capstone 3.0.0+ (https://www.capstone-engine.org/download.html)
3. **Test installation**
    
    ```bash
    python3 vol.py -h
    ```
    
    ‚Üí Displays help menu if installed correctly.
    

### Important

- For **Linux or Mac memory files**, you‚Äôll need symbol tables:
    
    üîó [Volatility Symbol Tables](https://github.com/volatilityfoundation/volatility3#symbol-tables)
    
- TryHackMe AttackBox already has Volatility pre-installed at:
    
    ```
    /opt/volatility3
    ```
    

---

## **Task 4: Memory Extraction**

### Tools for Extracting Memory Dumps

Used for capturing memory from **bare-metal or virtual machines**:

- FTK Imager
- Redline
- DumpIt.exe
- win32dd.exe / win64dd.exe
- Memoryze
- FastDump

![17eb1ceec9932bc5e445613ff5f5aa88.png](17eb1ceec9932bc5e445613ff5f5aa88.png)

### Memory Dump File Types

| Environment | Extension | Description |
| --- | --- | --- |
| Bare-metal | `.raw` | Standard memory dump |
| VMware | `.vmem` | VM memory file |
| Hyper-V | `.bin` | Hyper-V memory |
| Parallels | `.mem` | Parallels memory |
| VirtualBox | `.sav` | Partial memory file |

‚ö†Ô∏è **Caution:** Memory extraction can take significant time and may be incomplete if interrupted.

---

## **Task 5: Plugins Overview**

### Plugin System

- Volatility 3 **removed OS profiles**.
- The framework **auto-detects** the system type and build.
- Plugins are **OS-specific** now.

### Syntax Format

```
python3 vol.py -f <file> <os>.<plugin>
```

Examples:

- `windows.info`
- `linux.pslist`
- `mac.check_syscalls`

### Help Menu

Use:

```bash
python3 vol.py -h
```

to see all available plugins and usage info.

---

## **Task 6: Identifying Image Info & Profiles**

### Volatility 2 (Old Method)

- Used **imageinfo** plugin to identify OS profiles.
- Needed to manually choose the correct profile for analysis.

### Volatility 3 (Current)

- Profiles **deprecated** ‚Äî handled automatically.
- To identify image type and system info, use:
    
    ```bash
    python3 vol.py -f <file> windows.info
    python3 vol.py -f <file> linux.info
    python3 vol.py -f <file> mac.info
    
    ```
    

These commands extract OS version, build, and runtime information.

---

## **Task 7: Listing Processes and Connections**

### Process Listing Plugins

| Plugin | Description | Syntax |
| --- | --- | --- |
| **pslist** | Lists active and terminated processes (basic) | `python3 vol.py -f <file> windows.pslist` |
| **psscan** | Scans memory for `_EPROCESS` structures (detects hidden/rootkit processes) | `python3 vol.py -f <file> windows.psscan` |
| **pstree** | Displays processes hierarchically by parent-child relationship | `python3 vol.py -f <file> windows.pstree` |
| **dlllist** | Lists DLLs loaded by processes (useful for malware detection) | `python3 vol.py -f <file> windows.dlllist` |

### Network Plugin

| Plugin | Description | Syntax |
| --- | --- | --- |
| **netstat** | Lists network connections and sockets (may be unstable on older builds) | `python3 vol.py -f <file> windows.netstat` |

üí° If `netstat` fails, use **bulk_extractor** to extract PCAP files for network analysis.

---

## **Task 8: Volatility Hunting and Detection Capabilities**

### Key Plugins for Threat Hunting

| Plugin | Purpose | Syntax |
| --- | --- | --- |
| **malfind** | Detects injected or malicious code in memory | `python3 vol.py -f <file> windows.malfind` |
| **yarascan** | Scans memory for YARA rule matches | `python3 vol.py -f <file> windows.yarascan` |

### malfind Insights

- Detects memory regions with:
    - Executable permissions (RWE/RX)
    - No memory-mapped file (fileless malware)
- Shows **PID**, **offset**, **hex dump**, and **disassembly**.

### yarascan Usage

- Use with existing YARA file:
    
    ```bash
    python3 vol.py -f <file> windows.yarascan --yara-rules <rulefile.yar>
    
    ```
    
- Or define rules inline.

---

## **Task 9: Advanced Memory Forensics**

### Hooking & Evasion

Malware (especially rootkits) uses *hooking* to intercept or redirect system functions.

### Common Hook Types

1. **SSDT Hooks** (System Service Descriptor Table)
2. **IRP Hooks**
3. **IAT Hooks**
4. **EAT Hooks**
5. **Inline Hooks**

---

### Key Advanced Plugins

| Plugin | Purpose | Syntax |
| --- | --- | --- |
| **ssdt** | Detects SSDT hooking (rootkit evasion) | `python3 vol.py -f <file> windows.ssdt` |
| **modules** | Lists loaded kernel modules | `python3 vol.py -f <file> windows.modules` |
| **driverscan** | Scans for hidden or malicious drivers | `python3 vol.py -f <file> windows.driverscan` |

---

### Supporting/Third-Party Plugins

Used for deeper kernel/malware analysis:

- `modscan`
- `driverirp`
- `callbacks`
- `idt`
- `apihooks`
- `moddump`
- `handles`

Some of these are **Volatility 2 only** or third-party extensions.

---

## **Summary**

- Volatility analyzes volatile memory independent of the system.
- Volatility 3 simplifies investigation with **auto OS detection** and **plugin-based architecture**.
- It‚Äôs a powerful **incident response** and **malware detection** tool in digital forensics.